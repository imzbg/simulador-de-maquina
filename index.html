<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simulador de Maquina - Teoria da Computacao</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <div class="hero">
      <h1>Simulador de Maquina</h1>
      <p>
        Configure registradores de entrada e saida, atribua operacoes e testes
        por registrador, descreva o programa condicional e acompanhe o log da
        computacao passo a passo.
      </p>
    </div>
  </header>

  <main>
    <div class="layout">
      <div class="content-flow">
        <section class="panel" id="machine-def">
          <h2>1) Definicao da Maquina</h2>
          <div class="machine-grid">
            <div class="machine-config">
              <label>Quantidade de registradores (1-16)
                <input type="number" id="numRegisters" min="1" max="16" value="5" />
              </label>
              <p class="helper-text">
                Clique nos registradores para marca-los como entrada ou saida e
                selecione as operacoes e testes disponiveis por registrador.
              </p>
              <div class="buttons compact">
                <button id="saveMachineFile" type="button">Salvar maquina (.json)</button>
                <button id="loadMachineFile" type="button">Carregar maquina</button>
                <input type="file" id="machineFileInput" accept="application/json" hidden />
              </div>
              <div class="register-groups">
                <div class="register-card">
                  <h3>Registradores de entrada</h3>
                  <div id="inputRegisters" class="register-grid"></div>
                </div>
                <div class="register-card">
                  <h3>Registradores de saida</h3>
                  <div id="outputRegisters" class="register-grid"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="machine-ops-grid">
            <div class="ops-card">
              <h3>Operacoes matematicas por registrador</h3>
              <div id="mathOperations"></div>
            </div>
            <div class="ops-card">
              <h3>Testes logicos por registrador</h3>
              <div id="logicTests"></div>
            </div>
          </div>
          <div class="machine-summary machine-summary-full">
            <h3>Representacao textual</h3>
            <pre id="machineOutput" class="output"></pre>
          </div>
        </section>

        <section class="panel" id="program-def">
          <h2>2) Definicao do Programa</h2>
          <p class="helper-text">
            Cada linha segue o formato <code>rotulo: se REG TESTE entao vá para X senao vá para Y</code>. Use os botoes abaixo para montar o programa.
          </p>
          <div id="programLines" class="program-lines"></div>
          <div class="buttons">
            <button id="addProgramLine" type="button">Adicionar linha</button>
          </div>
          <div class="output-box">
            <h3>Representacao textual</h3>
            <pre id="programOutput" class="output"></pre>
          </div>
        </section>

        <section class="panel" id="execution">
          <h2>3) Computacao</h2>
          <div class="row">
            <div class="col">
              <h3>Valores de entrada</h3>
              <div id="inputValues" class="value-list"></div>
              <button id="executeProgram" type="button">Computar</button>
            </div>
            <div class="col">
              <h3>Valores de saida</h3>
              <div id="outputValues" class="value-list"></div>
            </div>
          </div>
          <h3>Log de execucao</h3>
          <div id="computationLog" class="log-box"></div>
        </section>
      </div>

      <aside class="side-help">
        <div class="side-card guide-card">
          <h2>Guia rapido</h2>
          <ol class="step-list">
            <li>
              <a href="#machine-def">Defina a maquina</a>
              <p>Escolha quantos registradores deseja e marque quais sao usados como entrada e saida.</p>
            </li>
            <li>
              <a href="#program-def">Monte o programa</a>
              <p>Construa as linhas condicionais informando o proximo rotulo para cada resultado.</p>
            </li>
            <li>
              <a href="#execution">Execute e analise</a>
              <p>Preencha os valores de entrada, clique em <strong>Computar</strong> e observe o log gerado.</p>
            </li>
          </ol>
        </div>

        <div class="side-card instructions-card">
          <h2>Operacoes e testes</h2>
          <ul class="instruction-list">
            <li>Selecione apenas uma operacao matematica por registrador.</li>
            <li>Associe um teste logico por registrador para controlar saltos.</li>
            <li>Os rotulos podem ser alfanumericos e servem para ligar as linhas.</li>
            <li>Se um rotulo nao for encontrado o programa encerra automaticamente.</li>
            <li>O log mostra o valor do registrador testado e o destino escolhido.</li>
          </ul>
        </div>
      </aside>
    </div>
  </main>

  <div id="saveModal" class="modal" aria-hidden="true" role="dialog">
    <div class="modal-content">
      <h3>Salvar definicao</h3>
      <p>Deseja incluir a definicao do programa no arquivo exportado?</p>
      <div class="modal-buttons">
        <button id="saveMachineOnly" type="button">Somente maquina</button>
        <button id="saveMachineWithProgram" type="button">Maquina + programa</button>
        <button id="cancelSaveModal" type="button" class="ghost">Cancelar</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
