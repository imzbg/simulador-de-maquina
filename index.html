<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simulador de Máquina - Teoria da Computação</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <div class="hero">
      <h1>Simulador de Máquina</h1>
      <p>
        Configure registradores de entrada e saída, atribua operações e testes
        por registrador, descreva o programa condicional e acompanhe o log da
        computação passo a passo.
      </p>
    </div>
  </header>

  <main>
    <div class="layout">
      <div class="content-flow">
        <section class="panel" id="machine-def">
          <h2>1) Definição da Máquina</h2>
          <div class="machine-grid">
            <div class="machine-config">
              <label>Quantidade de registradores (1-16)
                <input type="number" id="numRegisters" min="1" max="16" value="5" />
              </label>
              <p class="helper-text">
                Clique nos registradores para marcá-los como entrada ou saída e
                selecione as operações e testes disponíveis por registrador.
              </p>
              <div class="buttons compact">
                <button id="saveMachineFile" type="button">Salvar máquina (.json)</button>
                <button id="loadMachineFile" type="button">Carregar máquina</button>
                <input type="file" id="machineFileInput" accept="application/json" hidden />
              </div>
              <div class="register-groups">
                <div class="register-card">
                  <h3>Registradores de entrada</h3>
                  <div id="inputRegisters" class="register-grid"></div>
                </div>
                <div class="register-card">
                  <h3>Registradores de saída</h3>
                  <div id="outputRegisters" class="register-grid"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="machine-ops-grid">
            <div class="ops-card">
              <h3>Operações matemáticas por registrador</h3>
              <div id="mathOperations"></div>
            </div>
            <div class="ops-card">
              <h3>Testes lógicos por registrador</h3>
              <div id="logicTests"></div>
            </div>
          </div>
          <div class="machine-summary machine-summary-full">
            <h3>Representação textual</h3>
            <pre id="machineOutput" class="output"></pre>
          </div>
        </section>

        <section class="panel" id="program-def">
          <h2>2) Definição do Programa</h2>
          <p class="helper-text">
            Cada linha pode ser configurada como <code>se</code> (usa um teste lógico disponível para o registrador)
            ou <code>faça</code> (executa uma operação atribuída ao registrador com um <strong>valor inteiro</strong>
            e segue para um rótulo). O valor aparece em um campo ao lado da operação.
          </p>
          <div id="programLines" class="program-lines"></div>
          <div class="buttons">
            <button id="addProgramLine" type="button">Adicionar linha</button>
          </div>
          <div class="output-box">
            <h3>Representação textual</h3>
            <pre id="programOutput" class="output"></pre>
          </div>
        </section>

        <section class="panel" id="execution">
          <h2>3) Computação</h2>
          <div class="row">
            <div class="col">
              <h3>Valores de entrada</h3>
              <div id="inputValues" class="value-list"></div>
              <button id="executeProgram" type="button">Computar</button>
            </div>
            <div class="col">
              <h3>Valores de saída</h3>
              <div id="outputValues" class="value-list"></div>
            </div>
          </div>
          <h3>Log de execução</h3>
          <div id="computationLog" class="log-box"></div>
        </section>
      </div>

      <aside class="side-help">
        <div class="side-card guide-card">
          <h2>Guia rápido</h2>
          <ol class="step-list">
            <li>
              <a href="#machine-def">Defina a máquina</a>
              <p>Escolha quantos registradores deseja e marque quais são usados como entrada e saída.</p>
            </li>
            <li>
              <a href="#program-def">Monte o programa</a>
              <p>Construa as linhas condicionais informando o próximo rótulo para cada resultado.</p>
            </li>
            <li>
              <a href="#execution">Execute e analise</a>
              <p>Preencha os valores de entrada, clique em <strong>Computar</strong> e observe o log gerado.</p>
            </li>
          </ol>
        </div>

        <div class="side-card instructions-card">
          <h2>Operações e testes</h2>
          <ul class="instruction-list">
            <li>Selecione uma ou mais operações matemáticas disponíveis por registrador.</li>
            <li>Associe um ou mais testes lógicos por registrador para controlar saltos.</li>
            <li>As operações e testes usados no programa aparecem conforme forem habilitados na definição da máquina.</li>
            <li>Os rótulos podem ser alfanuméricos e servem para ligar as linhas.</li>
            <li>Se um rótulo não for encontrado o programa encerra automaticamente.</li>
            <li>O log mostra o valor do registrador testado, o valor do parâmetro da operação e o destino escolhido.</li>
          </ul>
        </div>
      </aside>
    </div>
  </main>

  <div id="saveModal" class="modal" aria-hidden="true" role="dialog">
    <div class="modal-content">
      <h3>Salvar definição</h3>
      <p>Deseja incluir a definição do programa no arquivo exportado?</p>
      <div class="modal-buttons">
        <button id="saveMachineOnly" type="button">Somente máquina</button>
        <button id="saveMachineWithProgram" type="button">Máquina + programa</button>
        <button id="cancelSaveModal" type="button" class="ghost">Cancelar</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
